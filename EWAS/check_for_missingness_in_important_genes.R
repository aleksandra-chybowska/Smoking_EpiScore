library("stringr")
library("foreach")
library("doParallel")
library("crayon")

setwd("<cluster_home_dir>/ONT/methrix/")
home = "<cluster_home_dir>/"
approach = "normal"
filename = "5_32"

meth = readRDS(paste0(filename, "_before_EWAS.RDS"))
pheno = readRDS(paste0(filename, "_before_EWAS_pheno.RDS"))

#chr5:321,714-438,291 - long gene
AHRR = c("chr5-373078-373079",
        "chr5-373088-373089",
        "chr5-373133-373134",
        "chr5-373135-373136",
        "chr5-373200-373201",
        "chr5-373238-373239",
        "chr5-373240-373241",
        "chr5-373263-373264",
        "chr5-373283-373284",
        "chr5-395372-395373")


ALPPL2 = c("chr2-227164719-227164720",
"chr2-232418300-232418301",
"chr2-232419275-232419276",
"chr2-232419419-232419420",
"chr2-232419463-232419464",
"chr2-232419477-232419478",
"chr2-232419540-232419541",
"chr2-232419552-232419553",
"chr2-232419555-232419556",
"chr2-232419559-232419560",
"chr2-232419586-232419587",
"chr2-232419598-232419599",
"chr2-232419609-232419610",
"chr2-232419621-232419622",
"chr2-232419624-232419625",
"chr2-232419641-232419642",
"chr2-232419656-232419657",
"chr2-232419669-232419670",
"chr2-232419692-232419693",
"chr2-232419736-232419737",
"chr2-232419743-232419744",
"chr2-232419745-232419746",
"chr2-232419779-232419780",
"chr2-232419781-232419782",
"chr2-232419784-232419785",
"chr2-232419791-232419792",
"chr2-232419794-232419795",
"chr2-232419800-232419801",
"chr2-232419807-232419808",
"chr2-232419828-232419829",
"chr2-232419831-232419832",
"chr2-232419867-232419868",
"chr2-232419871-232419872",
"chr2-232419875-232419876",
"chr2-232419907-232419908",
"chr2-232419951-232419952",
"chr2-232419961-232419962",
"chr2-232419964-232419965",
"chr2-232419980-232419981",
"chr2-232419982-232419983",
"chr2-232419992-232419993",
"chr2-232420022-232420023",
"chr2-232420037-232420038",
"chr2-232420050-232420051",
"chr2-232420064-232420065",
"chr2-232420079-232420080",
"chr2-232420125-232420126",
"chr2-232420130-232420131",
"chr2-232420302-232420303",
"chr2-232420339-232420340",
"chr2-232420432-232420433",
"chr2-232421440-232421441",
"chr2-232421622-232421623")

F2RL3 = c("chr19-16889741-16889742",
        "chr19-16889774-16889775",
        "chr19-16889785-16889786")

AHRR_present = AHRR %in% colnames(meth)
ALPPL2_present = ALPPL2 %in% colnames(meth)
F2RL3_present = F2RL3 %in% colnames(meth)

genes = list("AHRR" = AHRR_present, 
            "ALPPL2" = ALPPL2_present, 
            "F2RL3" = F2RL3_present)

for (name in names(genes)) {
    if (!any(genes[[name]])) {
        cat(paste0(name, " is not there ", red("X\n")))
    } else {
        cat(paste0(name, " present ", green("âœ”\n")))
        tally = as.integer(genes[[name]])
        cat(paste0(sum(tally), " CpGs / ", length(tally), " suggestive TWIST CpGs\n"))
    }
}
filename
